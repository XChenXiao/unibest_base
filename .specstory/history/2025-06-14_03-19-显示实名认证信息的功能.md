<!-- Generated by SpecStory -->

# 显示实名认证信息的功能 (2025-06-14 11:19:51)

_**User**_

@index.vue 现在我需要“我的”页面中点击实名认证之后，如果用户已经实名则可以看到用户的实名信息

---

_**Assistant**_

我将修改"我的"页面，使得点击实名认证后，如果用户已经实名认证，则可以查看用户的实名信息。

---

```diff
  // 处理个人信息点击
  const handleProfileClick = () => {
-   // 如果已经实名认证，显示简单提示
+   // 如果已经实名认证，跳转到实名信息页面
    if (verificationStore.isVerified) {
-     uni.showToast({
-       title: '您已实名',
-       icon: 'success',
-       duration: 1500,
-     })
+     navigateTo('/pages/my/identity-info')
      return
    }
```

---

现在我需要创建一个新的页面来显示用户的实名信息：

---

<details>
            <summary>Searched codebase "identity-verify" • **2** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |

</details>

---

Read file: src/pages/my/identity-verify.vue

---

Read file: src/pages/my/identity-verify.vue

---

<no message>

---

Read file: src/pages/my/identity-verify.vue

---

现在我需要创建一个新的页面来显示用户的实名信息：

---

```diff
- 
+ <route lang="json5">
+ {
+   style: {
+     navigationBarTitleText: '实名信息',
+   },
+ }
+ </route>
+ 
+ <template>
+   <view class="identity-info-container">
+     <!-- 顶部波浪装饰 -->
+     <view class="wave-decoration"></view>
+ 
+     <!-- 返回按钮 -->
+     <view class="back-button" @click="goBack">
+       <text class="uni-icons uniui-arrow-left"></text>
+     </view>
+ 
+     <!-- 页面标题 -->
+     <view class="page-title">
+       <text class="title-text">实名信息</text>
+     </view>
+ 
+     <!-- 认证状态展示 -->
+     <view class="verify-status-card">
+       <view class="status-icon approved-icon">
+         <text class="uni-icons uniui-checkmark-filled"></text>
+       </view>
+       <text class="status-text">认证已通过</text>
+       <text class="status-desc">您已完成实名认证，可以使用完整的平台功能</text>
+     </view>
+ 
+     <!-- 已通过状态下的信息展示 -->
+     <view class="verify-info">
+       <view class="info-group">
+         <text class="info-label">姓名</text>
+         <text class="info-value">{{ userInfo.name }}</text>
+       </view>
+       <view class="info-group">
+         <text class="info-label">身份证号</text>
+         <text class="info-value">{{ maskIdNumber(userInfo.idNumber) }}</text>
+       </view>
+       <view class="info-group" v-if="userInfo.verifyTime">
+         <text class="info-label">认证时间</text>
+         <text class="info-value">{{ formatDate(userInfo.verifyTime) }}</text>
+       </view>
+     </view>
+ 
+     <!-- 底部版权信息 -->
+     <view class="verify-footer">
+       <text></text>
+     </view>
+   </view>
+ </template>
+ 
+ <script lang="ts" setup>
+ import { ref, reactive, onMounted } from 'vue'
+ import { useUserStore, useVerificationStore } from '@/store'
+ import { getVerificationStatusAPI } from '@/service/index/verification'
+ 
+ // 获取用户状态
+ const userStore = useUserStore()
+ const verificationStore = useVerificationStore()
+ 
+ // 用户信息
+ const userInfo = reactive({
+   name: '',
+   idNumber: '',
+   verifyTime: '',
+ })
+ 
+ // 身份证号码脱敏处理
+ const maskIdNumber = (idNumber: string) => {
+   if (!idNumber) return ''
+   return idNumber.replace(/^(.{6})(.*)(.{4})$/, '$1****$3')
+ }
+ 
+ // 格式化日期
+ const formatDate = (dateString: string) => {
+   if (!dateString) return ''
+   try {
+     const date = new Date(dateString)
+     return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`
+   } catch (e) {
+     return dateString
+   }
+ }
+ 
+ // 页面加载时获取认证信息
+ onMounted(async () => {
+   // 从用户信息中获取基本信息
+   userInfo.name = userStore.userInfo.name || ''
+   
+   try {
+     // 获取认证详情
+     const res = await getVerificationStatusAPI()
+     
+     // 基于API返回的数据结构访问verification对象
+     if (res.status === 'success' && res.data) {
+       // 获取认证信息
+       const verificationData = res.data
+       
+       if (verificationData.data && verificationData.data.verification) {
+         // 填充用户信息
+         const verification = verificationData.data.verification
+         userInfo.name = verification.real_name || userInfo.name
+         userInfo.idNumber = verification.id_card_number || ''
+         userInfo.verifyTime = verification.verified_at || verification.updated_at || ''
+       }
+     }
+   } catch (error) {
+     console.error('获取认证详情失败', error)
+     // 使用基础用户信息作为备选
+     userInfo.name = userStore.userInfo.name || ''
+     
+     // 显示错误提示
+     uni.showToast({
+       title: '获取认证信息失败',
+       icon: 'none'
+     })
+   }
+ })
+ 
+ // 返回上一页
+ const goBack = () => {
+   uni.navigateBack()
+ }
+ </script>
+ 
+ <style lang="scss">
+ /* 全局重置 */
+ page {
+   background-color: #f5f5f5;
+   height: 100%;
+   font-family: 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
+ }
+ 
+ /* 容器样式 */
+ .identity-info-container {
+   display: flex;
+   flex-direction: column;
+   min-height: 100vh;
+   position: relative;
+ }
+ 
+ /* 顶部波浪装饰 */
+ .wave-decoration {
+   position: absolute;
+   top: 0;
+   left: 0;
+   width: 100%;
+   height: 16rpx;
+   background: linear-gradient(to right, #f39c12, #e74c3c);
+ }
+ 
+ /* 返回按钮 */
+ .back-button {
+   position: absolute;
+   top: 60rpx;
+   left: 20rpx;
+   width: 80rpx;
+   height: 80rpx;
+   display: flex;
+   align-items: center;
+   justify-content: center;
+   font-size: 40rpx;
+   color: #333;
+   z-index: 10;
+ }
+ 
+ /* 页面标题 */
+ .page-title {
+   text-align: center;
+   margin-top: 130rpx;
+   margin-bottom: 40rpx;
+ }
+ 
+ .title-text {
+   font-size: 40rpx;
+   font-weight: 600;
+   color: #333;
+ }
+ 
+ /* 认证状态卡片 */
+ .verify-status-card {
+   background-color: white;
+   border-radius: 20rpx;
+   margin: 20rpx 30rpx 30rpx;
+   padding: 40rpx;
+   box-shadow: 0 8rpx 24rpx rgba(0, 0, 0, 0.08);
+   display: flex;
+   flex-direction: column;
+   align-items: center;
+ }
+ 
+ .status-icon {
+   width: 120rpx;
+   height: 120rpx;
+   border-radius: 50%;
+   display: flex;
+   align-items: center;
+   justify-content: center;
+   margin-bottom: 20rpx;
+ }
+ 
+ .approved-icon {
+   background-color: rgba(46, 204, 113, 0.1);
+ }
+ 
+ .approved-icon .uni-icons {
+   color: #2ecc71;
+   font-size: 60rpx;
+ }
+ 
+ .status-text {
+   font-size: 36rpx;
+   font-weight: 600;
+   color: #333;
+   margin-bottom: 15rpx;
+ }
+ 
+ .status-desc {
+   font-size: 28rpx;
+   color: #666;
+   text-align: center;
+ }
+ 
+ /* 认证信息展示 */
+ .verify-info {
+   background-color: white;
+   border-radius: 20rpx;
+   margin: 0 30rpx 30rpx;
+   padding: 30rpx;
+   box-shadow: 0 8rpx 24rpx rgba(0, 0, 0, 0.08);
+ }
+ 
+ .info-group {
+   display: flex;
+   justify-content: space-between;
+   padding: 20rpx 0;
+   border-bottom: 1px solid #f0f0f0;
+ }
+ 
+ .info-group:last-child {
+   border-bottom: none;
+ }
+ 
+ .info-label {
+   font-size: 28rpx;
+   color: #666;
+ }
+ 
+ .info-value {
+   font-size: 28rpx;
+   color: #333;
+   font-weight: 500;
+ }
+ 
+ /* 底部版权信息 */
+ .verify-footer {
+   text-align: center;
+   padding: 30rpx 0;
+   color: #999;
+   font-size: 24rpx;
+   margin-top: auto;
+ }
+ </style> 
```

---

Read file: src/service/index/verification.ts

---

<no message>

---

<details>
            <summary>Searched codebase "pages.json 查找路由配置" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/pages.json` | L57-143 |
| `src/utils/index.ts` | L74-108 |
| `src/pages.json` | L295-374 |
| `src/pages.json` | L1-57 |
| `pages.config.ts` | L1-61 |
| `src/pages.json` | L143-212 |
| `src/utils/index.ts` | L114-120 |
| `src/utils/index.ts` | L108-114 |
| `src/utils/index.ts` | L1-10 |
| `src/pages.json` | L212-295 |
| `src/pages.json` | L374-392 |
| `src/App.vue` | L1-57 |
| `src/interceptors/route.ts` | L1-27 |
| `.vscode/settings.json` | L1-63 |
| `src/pages/index/index.vue` | L1-60 |
| `src/utils/index.ts` | L24-44 |
| `vite.config.ts` | L47-97 |
| `src/manifest.json` | L50-115 |
| `pages.config.ts` | L61-101 |
| `src/interceptors/route.ts` | L50-96 |
| `src/uni_modules/uni-pagination/components/uni-pagination/i18n/zh-Hans.json` | L1-6 |
| `.cursor/rules/unibest-plugins.mdc` | L1-70 |
| `src/pages/my/settings.vue` | L1-54 |
| `manifest.config.ts` | L1-47 |
| `src/App.vue` | L57-111 |

</details>

---

现在我需要更新pages.json文件，添加新创建的实名信息页面：

---

```diff
        }
      },
+     {
+       "path": "pages/my/identity-info",
+       "type": "page",
+       "style": {
+         "navigationBarTitleText": "实名信息"
+       }
+     },
      {
        "path": "pages/my/index",
```

---

我已经完成了所需的功能实现：

1. 修改了"我的"页面中的`handleProfileClick`函数，使得当用户已经实名认证时，点击"个人信息"会跳转到实名信息页面，而不是仅显示简单提示。

2. 创建了一个新的`identity-info.vue`页面，用于显示用户的实名认证信息，包括：
   - 姓名
   - 身份证号（已脱敏处理）
   - 认证时间

3. 在`pages.json`中添加了新页面的路由配置。

现在，当用户点击"我的"页面中的"个人信息"选项时：
- 如果用户已完成实名认证，将跳转到新创建的实名信息页面，显示详细的认证信息
- 如果用户未认证或认证被拒绝，仍然会跳转到实名认证页面
- 如果用户认证正在审核中，会显示相应提示

这样实现了您的需求，让已实名认证的用户可以查看自己的实名信息。

---

